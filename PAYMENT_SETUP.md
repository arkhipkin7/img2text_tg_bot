# üí≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ –ÆKassa

## üéØ –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ÆKassa API** - –≥–æ—Ç–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π  
‚úÖ **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π** - –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ—Ç –≤—ã–±–æ—Ä–∞ —Ç–∞—Ä–∏—Ñ–∞ –¥–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏  
‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç–µ–∂–∞  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫  
‚úÖ **–ü—Ä–æ–¥–∞–∫—à–Ω –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å** - –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ù–î–° 20% –∏ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è —á–µ–∫–∞  

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –ÆKassa

1. **–í–æ–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –ÆKassa:** https://yookassa.ru/
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "API"**
3. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ:**
   - **Shop ID** (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞)
   - **Secret Key** (—Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á)

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ .env

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# Bot Configuration
BOT_TOKEN=your_bot_token_here
ADMIN_IDS=123456789,987654321
ADMIN_ID=123456789

# API Configuration
API_EXTERNAL_PORT=8001
API_INTERNAL_PORT=8000

# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4o-mini
OPENAI_MAX_TOKENS=4000

# YooKassa Configuration
YOOMONEY_SHOP_ID=your_shop_id_here
YOOMONEY_SECRET_KEY=your_secret_key_here
YOOMONEY_RETURN_URL=https://t.me/your_bot_username
```

**–í–∞–∂–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç–µ `your_shop_id_here` –∏ `your_secret_key_here` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –ÆKassa.

### –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –±–æ—Ç (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
docker-compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
docker-compose up -d
```

### –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –∫–æ–º–∞–Ω–¥—É** `/start`
2. **–í—ã–±–µ—Ä–∏—Ç–µ "üíé –ü–æ–¥–ø–∏—Å–∫–∏"**
3. **–í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π —Ç–∞—Ä–∏—Ñ**
4. **–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã** (–∫–∞—Ä—Ç–∞, –°–ë–ü, –ÆMoney)
5. **–ù–∞–∂–º–∏—Ç–µ "–û–ø–ª–∞—Ç–∏—Ç—å"** - –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ÆKassa
6. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ–ø–ª–∞—Ç—É** —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã

### –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã:
- **–£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞:** `5555 5555 5555 4477`
- **–û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è:** `5555 5555 5555 4444`
- **CVV:** –ª—é–±–æ–π 3-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
- **–°—Ä–æ–∫:** –ª—é–±–æ–π –±—É–¥—É—â–∏–π –º–µ—Å—è—Ü/–≥–æ–¥

### –°–ë–ü:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±–æ–π –º–æ–±–∏–ª—å–Ω—ã–π –±–∞–Ω–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –°–ë–ü

### –ÆMoney:
- –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ—à–µ–ª–µ–∫ –≤ –ÆMoney

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–ø–ª–∞—Ç–∞

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∞—Ä–∏—Ñ** ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–ª–∞—Ç–µ–∂ –≤ –ÆKassa
2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –æ–ø–ª–∞—Ç–µ** ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ÆKassa
3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç** ‚Üí –ÆKassa –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–ª–∞—Ç–µ–∂
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –±–æ—Ç** ‚Üí –Ω–∞–∂–∏–º–∞–µ—Ç "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å"
5. **–ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å** ‚Üí –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã

### –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa:

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–°–ø–æ—Å–æ–±—ã –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π"**
2. **–í–∫–ª—é—á–∏—Ç–µ –Ω—É–∂–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã:**
   - ‚úÖ **–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã** (–≤–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - ‚úÖ **–°–ë–ü** (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)
   - ‚úÖ **–ÆMoney** (—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –∫–æ—à–µ–ª–µ–∫)

## üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–µ–π:

1. **–í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa** ‚Üí "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
2. **–î–æ–±–∞–≤—å—Ç–µ URL:** `https://your-domain.com/webhook/yoomoney`
3. **–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è:** `payment.succeeded`, `payment.canceled`

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–ª–∞—Ç–µ–∂–µ–π

### –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa –¥–æ—Å—Ç—É–ø–Ω–æ:
- üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π**
- üí∞ **–ë–∞–ª–∞–Ω—Å –∏ –≤—ã–≤–æ–¥—ã**
- üîÑ **–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**
- üìß **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**

### –í –±–æ—Ç–µ:
- üìã **–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π** (–≤ —Ä–∞–∑–¥–µ–ª–µ –ø–æ–¥–ø–∏—Å–æ–∫)
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**
- üí≥ **–°—Ç–∞—Ç—É—Å —Ç–µ–∫—É—â–µ–π –ø–æ–¥–ø–∏—Å–∫–∏**

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "Receipt is missing or illegal"
–≠—Ç–∞ –æ—à–∏–±–∫–∞ —Ä–µ—à–µ–Ω–∞! –í –∫–æ–¥–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è —á–µ–∫–∞:
- `customer.email` - email –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
- `items[].description` - –æ–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏
- `items[].amount.value` - —Å—Ç–æ–∏–º–æ—Å—Ç—å
- `items[].amount.currency` - –≤–∞–ª—é—Ç–∞ (RUB)
- `items[].vat_code` - –∫–æ–¥ –ù–î–° (1 = –ù–î–° 20%)
- `items[].quantity` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- `items[].payment_subject` - —Ç–∏–ø —Ç–æ–≤–∞—Ä–∞/—É—Å–ª—É–≥–∏ ("service")
- `items[].payment_mode` - —Å–ø–æ—Å–æ–± —Ä–∞—Å—á–µ—Ç–∞ ("full_prepayment")

## üö® –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- üîí **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ** —Ñ–∞–π–ª `.env` –≤ git
- üîí **–•—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏** –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
- üîí **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS** –¥–ª—è webhook URL –≤ –ø—Ä–æ–¥–∞–∫—à–Ω–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- üß™ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- üß™ **–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –±–æ–µ–≤–æ–π —Ä–µ–∂–∏–º** —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ö–æ–º–∏—Å—Å–∏–∏:
- üí≥ **–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã:** 2.8% + 15‚ÇΩ
- üì± **–°–ë–ü:** 0.4-0.7%
- üí∞ **–ÆMoney:** 2.8%

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–∞—à –±–æ—Ç –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑:
- üí≥ **–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã** (Visa, MasterCard, –ú–ò–†)
- üì± **–°–ë–ü** (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)
- üí∞ **–ÆMoney** (—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –∫–æ—à–µ–ª–µ–∫)

–í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –±—É–¥—É—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ÆKassa —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º –æ —Å—Ç–∞—Ç—É—Å–µ.

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞:** `docker-compose logs bot`
2. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **–ÆKassa –ø–æ–¥–¥–µ—Ä–∂–∫–∞:** https://yookassa.ru/support
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:** https://yookassa.ru/developers/api
