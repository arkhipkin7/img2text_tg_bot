import os
from typing import Set

MAX_FILE_SIZE = int(os.getenv("MAX_FILE_SIZE", 20 * 1024 * 1024))
MAX_TEXT_LENGTH = int(os.getenv("MAX_TEXT_LENGTH", 5000))

SUPPORTED_IMAGE_FORMATS: Set[str] = {'jpg', 'jpeg', 'png', 'webp', 'bmp', 'gif'}

TEMP_DIR = "temp"
UPLOAD_DIR = "uploads"

API_TIMEOUT = int(os.getenv("API_TIMEOUT", 60))
API_RETRY_ATTEMPTS = 3
API_RETRY_DELAY = 1

OPENAI_MAX_TOKENS = int(os.getenv("OPENAI_MAX_TOKENS", 1000))
OPENAI_MODEL = os.getenv("OPENAI_MODEL", "gpt-4o")

RATE_LIMIT_REQUESTS_PER_MINUTE = 60
RATE_LIMIT_REQUESTS_PER_HOUR = 1000

LOG_LEVEL = os.getenv("LOG_LEVEL", "INFO")
LOG_FORMAT = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# –°–æ–æ–±—â–µ–Ω–∏—è
MESSAGES = {
    "welcome": (
        "üéâ **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ–ø–∏—Å–∞–Ω–∏–π –¥–ª—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤**\n\n"
        "‚ö° **–ó–∞ 30 —Å–µ–∫—É–Ω–¥** —Å–æ–∑–¥–∞–º –≥–æ—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è Wildberries, Ozon, –Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç\n\n"
        "üéØ **–ß—Ç–æ –ø–æ–ª—É—á–∏—Ç–µ:**\n"
        "‚Ä¢ –ü—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ\n"
        "‚Ä¢ SEO-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ\n"
        "‚Ä¢ –ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏\n"
        "‚Ä¢ –¶–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é\n\n"
        "{quota_status}\n\n"
        "üöÄ **–ù–∞—á–Ω–∏—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:**"
    ),
    "image_received": (
        "üì∑ **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!**\n\n"
        "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:\n"
        "‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n"
        "‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ"
    ),
    "text_too_long": (
        "‚ùå **–¢–µ–∫—Å—Ç —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π!**\n\n"
        f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: {MAX_TEXT_LENGTH} —Å–∏–º–≤–æ–ª–æ–≤.\n"
        "–°–æ–∫—Ä–∞—Ç–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞."
    ),
    "file_too_large": (
        "‚ùå **–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π!**\n\n"
        f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: {MAX_FILE_SIZE // (1024*1024)}MB.\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞."
    ),
    "unsupported_format": (
        "‚ùå **–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞!**\n\n"
        f"–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: {', '.join(SUPPORTED_IMAGE_FORMATS)}.\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ."
    ),
    "error": (
        "‚ùå **–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞!**\n\n"
        "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."
    ),
    "processing": (
        "‚è≥ **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –≤–∞—à –∑–∞–ø—Ä–æ—Å...**\n\n"
        "–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥."
    ),
    "text_received": (
        "üìù **–¢–µ–∫—Å—Ç –ø–æ–ª—É—á–µ–Ω!**\n\n"
        "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:\n"
        "‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç\n"
        "‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞"
    ),
    "help": (
        "‚ÑπÔ∏è **–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º:**\n\n"
        "1. **üì∑ –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ** - –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞\n"
        "2. **üìù –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç** - –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞\n"
        "3. **üì∑üìù –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ–±–∞** - –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ + –æ–ø–∏—Å–∞–Ω–∏–µ\n\n"
        "–ë–æ—Ç —Å–æ–∑–¥–∞—Å—Ç:\n"
        "‚Ä¢ –ü—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ\n"
        "‚Ä¢ –ö—Ä–∞—Ç–∫–æ–µ –∏ –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ\n"
        "‚Ä¢ –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏\n"
        "‚Ä¢ SEO-–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞\n"
        "‚Ä¢ –¶–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é\n\n"
        "–ì–æ—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ Wildberries, Ozon –∏ –¥—Ä—É–≥–∏—Ö –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞—Ö!"
    ),
    "demo_result": (
        "üé¨ **–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ '–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏':**\n\n"
        "üéØ **–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏ TWS —Å —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º**\n\n"
        "üìù **–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:**\n–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏ —Å –∞–∫—Ç–∏–≤–Ω—ã–º —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º –∏ Hi-Fi –∑–≤—É–∫–æ–º.\n\n"
        "üìÑ **–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:**\n–û—Ç–∫—Ä–æ–π—Ç–µ –º–∏—Ä —á–∏—Å—Ç–æ–≥–æ –∑–≤—É–∫–∞ —Å –Ω–∞—à–∏–º–∏ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–º–∏ –Ω–∞—É—à–Ω–∏–∫–∞–º–∏ TWS. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ 95% –≤–Ω–µ—à–Ω–∏—Ö –∑–≤—É–∫–æ–≤...\n\n"
        "‚ú® **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**\n‚Ä¢ Bluetooth 5.0\n‚Ä¢ –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: 6+24 —á–∞—Å–∞\n‚Ä¢ –ë—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞\n\n"
        "üîç **SEO-–∫–ª—é—á–∏:** –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏, TWS, —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ, Hi-Fi\n\n"
        "üí° **–•–æ—Ç–∏—Ç–µ —Ç–∞–∫–æ–π –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –≤–∞—à–µ–≥–æ —Ç–æ–≤–∞—Ä–∞?**"
    ),
    "direct_processing": (
        "‚ö° **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å...**\n\n"
        "{quota_status}\n\n"
        "‚è≥ –°–æ–∑–¥–∞—é –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞..."
    ),
    "quota_exceeded": (
        "üî¥ **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å—á–µ—Ä–ø–∞–Ω—ã**\n\n"
        "üí° **–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ —Å –ª—é–±—ã–º —Ç–∞—Ä–∏—Ñ–æ–º:**\n"
        "‚Ä¢ ‚ö° **–†–∞–∑–æ–≤—ã–π** - –≤—Å–µ–≥–æ 20‚ÇΩ –∑–∞ 1 –∑–∞–ø—Ä–æ—Å\n"
        "‚Ä¢ üå± **–°—Ç–∞—Ä—Ç–µ—Ä** - 180‚ÇΩ –∑–∞ 10 –∑–∞–ø—Ä–æ—Å–æ–≤\n"
        "‚Ä¢ üöÄ **–ü—Ä–æ—Ä—ã–≤** - 509‚ÇΩ –∑–∞ 30 –∑–∞–ø—Ä–æ—Å–æ–≤\n\n"
        "–ò–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∑–∞–≤—Ç—Ä–∞ –∑–∞ –Ω–æ–≤—ã–º–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏!"
    )
}

# –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
KEYBOARD_BUTTONS = {
    "process_image": "üì∑ –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",
    "process_text": "üìù –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç", 
    "process_both": "üì∑üìù –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ–±–∞",
    "help": "‚ÑπÔ∏è –ü–æ–º–æ—â—å",
    "back": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
    "process_now": "‚úÖ –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",
    "add_text": "üìù –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ"
}

# Callback data
CALLBACK_DATA = {
    "process_image_only": "process_image_only",
    "process_text_only": "process_text_only", 
    "process_both": "process_both",
    "help": "help",
    "back_to_start": "back_to_start",
    "process_image_now": "process_image_now",
    "add_text_to_image": "add_text_to_image",
    "back_to_image_menu": "back_to_image_menu"
} 